(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{300:function(s,t,a){"use strict";a.r(t);var n=a(9),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"用docker-搭建-gitlab服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用docker-搭建-gitlab服务器"}},[s._v("#")]),s._v(" 用Docker 搭建 GitLab服务器")]),s._v(" "),a("ol",[a("li",[s._v("在 https://hub.docker.com/ 上输入gitlab")]),s._v(" "),a("li",[s._v("点击gitlab-ce链接进入一个页面，在这个页面中就可以看到安装gitLab的命令："),a("code",[s._v("docker pull gitlab/gitlab-ce")])]),s._v(" "),a("li",[s._v("运行：通常会将gitlab的配置(etc)、日志(log)、数据(data)放到容器之外，便于日后升级，因此，先准备这三个目录")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /srv/gitlab/etc\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /srv/gitlab/log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /srv/gitlab/data\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("运行gitlab镜像")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("docker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --detach "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --publish "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v(":443 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --publish "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --publish "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2222")]),s._v(":22 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --name gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --restart always "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -v /srv/gitlab/etc:/etc/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -v /srv/gitlab/log:/var/log/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -v /srv/gitlab/data:/var/opt/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    gitlab/gitlab-ce\n\n---\n\n注释：\n--detach  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置容器后台运行")]),s._v("\n--hostname xxx.xx.xx.xx  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置容器的hostname")]),s._v("\n--publish "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v(":443  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器443端口映射到主机8443端口")]),s._v("\n--publish "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v(":80  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器80端口映射到主机9090端口")]),s._v("\n--publish "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2222")]),s._v(":22  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器 22端口映射到主机2222端口")]),s._v("\n--restart always   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器退出后自动重启")]),s._v("\n-v /srv/gitlab/etc:/etc/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载本地目录到容器配置目录")]),s._v("\n-v /srv/gitlab/log:/var/log/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#挂载本地目录到容器日志目录")]),s._v("\n-v /srv/gitlab/data:/var/opt/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#挂载本地目录到容器数据目录")]),s._v("\ngitlab/gitlab-ce "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用的镜像")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("浏览器进入：http://xxx.xx.xx.xx:9090")])]),s._v(" "),a("p",[s._v("其他：\n如果9090端口被占用，会出现502的页面\n用docker把gitlab停掉，再次启动，会出现502错误，我的解决办法就是把9090端口的进程杀掉，就好了\n"),a("code",[s._v("ps -ef|grep 9090")]),s._v(" "),a("code",[s._v("kill -9 xxx")])]),s._v(" "),a("p",[s._v("或者：\n修改unicorn的配置，"),a("br"),s._v("\nvim /srv/gitlab/data/gitlab-rails/etc/unicorn.rb "),a("br"),s._v('\nlisten "127.0.0.1:9090", :tcp_nopush => true')])])}),[],!1,null,null,null);t.default=e.exports}}]);